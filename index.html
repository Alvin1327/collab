<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>2D Shooter Game</title>
<style>
  body { margin:0; overflow:hidden; background:#111; }
  #hud {
    position:fixed; top:10px; left:50%; transform:translateX(-50%);
    display:flex; gap:40px; font-family:sans-serif; font-size:18px; color:#fff;
  }
  .playerStat { padding:8px 12px; border-radius:8px; background:rgba(0,0,0,0.5); }
  #winner {
    position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
    font-size:36px; color:#fff; font-weight:bold; display:none;
  }
</style>
</head>
<body>
<canvas id="game"></canvas>
<div id="hud">
  <div id="p1stat" class="playerStat">P1 HP:100 Score:0</div>
  <div id="p2stat" class="playerStat">P2 HP:100 Score:0</div>
</div>
<div id="winner"></div>
<script>
const canvas=document.getElementById("game"),ctx=canvas.getContext("2d");
canvas.width=window.innerWidth; canvas.height=window.innerHeight;
const W=canvas.width,H=canvas.height;

// Game state
let players=[
  {x:100,y:H/2,color:"lime",hp:100,score:0,keys:{up:"KeyW",down:"KeyS",left:"KeyA",right:"KeyD",shoot:"Space"},bullets:[]},
  {x:W-120,y:H/2,color:"red",hp:100,score:0,keys:{up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",shoot:"Enter"},bullets:[]}
];
let keysDown={};
document.addEventListener("keydown",e=>keysDown[e.code]=true);
document.addEventListener("keyup",e=>keysDown[e.code]=false);

// Helpers
function drawPlayer(p){
  ctx.shadowColor=p.color; ctx.shadowBlur=20;
  ctx.fillStyle=p.color;
  ctx.fillRect(p.x,p.y,40,40);
  ctx.shadowBlur=0;
}
function drawBullet(b){ ctx.fillStyle="yellow"; ctx.beginPath(); ctx.arc(b.x,b.y,6,0,Math.PI*2); ctx.fill(); }
function autoAimAndShoot(p,enemy){
  if(p.cooldown>0) return;
  const dx=enemy.x-p.x,dy=enemy.y-p.y; const dist=Math.hypot(dx,dy);
  if(dist<400){ // auto aim within range
    const speed=6;
    const vx=dx/dist*speed,vy=dy/dist*speed;
    p.bullets.push({x:p.x+20,y:p.y+20,vx,vy});
    p.cooldown=20; // frames between shots
  }
}

// Game loop
function update(){
  players.forEach((p,i)=>{
    const k=p.keys;
    if(keysDown[k.up]) p.y-=4;
    if(keysDown[k.down]) p.y+=4;
    if(keysDown[k.left]) p.x-=4;
    if(keysDown[k.right]) p.x+=4;
    p.y=Math.max(0,Math.min(H-40,p.y));
    p.x=Math.max(0,Math.min(W-40,p.x));

    // Shooting
    const enemy=players[1-i];
    autoAimAndShoot(p,enemy);

    // Update bullets
    p.bullets.forEach(b=>{ b.x+=b.vx; b.y+=b.vy; });
    p.bullets=p.bullets.filter(b=>b.x>0&&b.x<W&&b.y>0&&b.y<H);

    // Check collisions
    p.bullets.forEach((b,bi)=>{
      if(b.x>enemy.x && b.x<enemy.x+40 && b.y>enemy.y && b.y<enemy.y+40){
        enemy.hp-=10; p.score++;
        p.bullets.splice(bi,1);
      }
    });

    if(p.cooldown>0) p.cooldown--;
  });

  // Winner check
  players.forEach((p,i)=>{
    if(p.hp<=0){
      document.getElementById("winner").textContent=`Player ${i===0?2:1} Wins!`;
      document.getElementById("winner").style.display="block";
      running=false;
    }
  });
}
function drawBackground(){
  let grad=ctx.createLinearGradient(0,0,0,H);
  grad.addColorStop(0,"#333"); grad.addColorStop(1,"#111");
  ctx.fillStyle=grad; ctx.fillRect(0,0,W,H);
}
function draw(){
  drawBackground();
  players.forEach(p=>{
    drawPlayer(p);
    p.bullets.forEach(drawBullet);
  });
  // Update HUD
  document.getElementById("p1stat").textContent=`P1 HP:${players[0].hp} Score:${players[0].score}`;
  document.getElementById("p2stat").textContent=`P2 HP:${players[1].hp} Score:${players[1].score}`;
}
let running=true;
function loop(){
  if(!running) return;
  update(); draw(); requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
